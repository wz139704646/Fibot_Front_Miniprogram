<!--pages/application/trialBalance/trialBalance.wxml-->
<wxs module='abs' src='abs.wxs'></wxs>
<cu-custom bgColor="bg-gradual-pink" isBack="{{true}}">
  <view slot="backText">返回</view>
  <view slot="content">科目余额</view>
</cu-custom>
<view style="position: fixed; top:{{CustomBar}}px; width: 100vw; height: 10vh; z-index:1000;">
  <view class="cu-form-group bg-grey light" style="border-bottom: 1px solid gainsboro;">
    <view class="text-bold">时间选择</view>
    <picker mode="multiSelector" bindchange="MultiChange" bindcolumnchange="MultiColumnChange" value="{{timeIndex}}" range="{{timeArray}}">
      <view class="picker">
        {{timeArray[0][timeIndex[0]]}}-{{ timeArray[1][timeIndex[1]]
        < 10 ? '0'+ timeArray[1][timeIndex[1]] : timeArray[1][timeIndex[1]] }}期 </view>
    </picker>
  </view>  
  <view class="cu-bar bg-grey light search">
    <view class="search-form round">
      <text class="cuIcon-search"></text>
      <input type="text" placeholder="输入科目代码或科目名" confirm-type="search" bindconfirm="search" bindinput="searchInput" value="{{searchText}}"></input>
    </view>
    <view class="action">
      <button class="cu-btn bg-black shadow-blur round" bindtap="search">搜索</button>
    </view>
  </view>
</view>
  <scroll-view style="margin-top: 15vh;">
    <block wx:for="{{filterTrials}}" wx:key="{{index}}" wx:for-item="main">
      <van-cell-group title="{{main.code}}">
        <van-collapse value="{{ main.activeNames }}" bind:change="onActiveChange" data-idx="{{index}}">
          <block wx:for="{{main.subs}}" wx:key="{{index}}" wx:for-item="sub" wx:for-index="idx">
            <van-collapse-item title="{{sub.code}} {{sub.name}}" name="{{sub.code}}">
              <view class="cu-bar bg-white cu-bar-item">
                <view>期初余额</view>
                <view>
                  <van-tag color="{{sub.init>0 ? '#0081ff' : '#f37b1d'}}" round>{{sub.init>0 ? "借" : "贷"}}</van-tag>
                  <text class="{{sub.init>0 ? 'text-blue' : 'text-orange'}}"> {{abs.abs(sub.init)}}</text>
                </view>
              </view>
              <view class="cu-bar bg-white cu-bar-item">
                <view>本期借方发生额</view>
                <view class="text-blue">{{sub.debit}}</view>
              </view>
              <view class="cu-bar bg-white cu-bar-item">
                <view>本期贷方发生额</view>
                <view class="text-orange">{{sub.credit}}</view>
              </view>
              <view class="cu-bar bg-white cu-bar-item">
                <view>期末余额</view>
                <view>
                  <van-tag color="{{sub.term>0 ? '#0081ff' : '#f37b1d'}}" round>{{sub.term>0 ? "借" : "贷"}}</van-tag>
                  <text class="{{sub.term>0 ? 'text-blue' : 'text-orange'}}"> {{abs.abs(sub.term)}}</text>
                </view>
              </view>
            </van-collapse-item>
          </block>
        </van-collapse>
      </van-cell-group>
    </block>
  </scroll-view>